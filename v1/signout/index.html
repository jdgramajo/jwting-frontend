<!DOCTYPE html>
<html lang="en" class="h-100">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x"
      crossorigin="anonymous"
    />
    <link rel="icon" type="image/svg" href="/jwt.svg" />
    <title>JWTING</title>
  </head>

  <body>
    <!-- EXTERNAL DEPENDENCIES START -->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
      integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT"
      crossorigin="anonymous"
    ></script>
    <!-- EXTERNAL DEPENDENCIES END -->

    <!-- SHARED COMPONENTS START -->
    <script src="/shared/v1/requests/session.js"></script>
    <script src="/shared/v1/router.js"></script>
    <!-- SHARED COMPONENTS END -->

    <!-- CONTROLLER (AND COMPONENT) START -->
    <script>
      const mainTitleDiv = document.createElement("div");
      mainTitleDiv.setAttribute(
        "class",
        "d-flex flex-row justify-content-center"
      );
      const mainTitleText = document.createElement("h1");
      mainTitleText.innerText = "Signing out...";
      mainTitleDiv.appendChild(mainTitleText);

      const hiddenSpinnerSpan = document.createElement("span");
      hiddenSpinnerSpan.setAttribute("class", "visually-hidden");
      hiddenSpinnerSpan.innerText = "Signing out...";

      const spinnerDiv = document.createElement("div");
      spinnerDiv.setAttribute("class", "spinner-border m-3");
      spinnerDiv.setAttribute("style", "width: 4rem; height: 4rem;");
      spinnerDiv.setAttribute("role", "status");
      spinnerDiv.appendChild(hiddenSpinnerSpan);

      const spinnerFlexContainerDiv = document.createElement("div");
      spinnerFlexContainerDiv.setAttribute(
        "class",
        "d-flex flex-row justify-content-center"
      );
      spinnerFlexContainerDiv.appendChild(spinnerDiv);

      const component = document.createElement("div");
      component.setAttribute(
        "class",
        "container col-xl-4 col-lg-4 col-md-4 col-sm-8"
      );
      component.setAttribute("style", "margin-top: 150px;");
      component.appendChild(mainTitleDiv);
      component.appendChild(spinnerFlexContainerDiv);

      document.body.appendChild(component);

      fetch(`${backendRootURL}/auth/signout`, {
        method: "POST",
        credentials: "include",
        headers: {
          Accept: "*/*",
          "Content-type": "application/json; charset=UTF-8",
        },
      })
        .then((response) => {
          if (response.ok) {
            router.toRoot();
          } else {
            throw new Error(response.statusText);
          }
        })
        .catch((err) => {
          console.log(`${err}`);
        });
    </script>
    <!-- CONTROLLER (AND COMPONENT) END -->
  </body>
</html>
